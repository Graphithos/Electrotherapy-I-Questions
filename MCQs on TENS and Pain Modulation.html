<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCQs on Electrotherapy 1 Lecture No. 3 Quiz</title>
    <style>
        :root {
            --bg-color: #f5f7fa;
            --container-bg: white;
            --text-color: #333;
            --border-color: #ddd;
            --primary-color: #3498db;
            --header-color: #2c3e50;
            --secondary-text: #7f8c8d;
            --progress-bg: #ecf0f1;
            --question-bg: #f8f9fa;
            --option-bg: #fff;
            --option-hover: #f1f8ff;
            --option-selected: #d1ecf1;
            --correct-bg: #d4edda;
            --correct-border: #28a745;
            --incorrect-bg: #f8d7da;
            --incorrect-border: #dc3545;
            --button-bg: #3498db;
            --button-hover: #2980b9;
            --button-disabled: #bdc3c7;
            --restart-bg: #2ecc71;
            --restart-hover: #27ae60;
            --review-bg: #f39c12;
            --review-hover: #e67e22;
            --toggle-bg: #ecf0f1;
            --toggle-slider: white;
            --toggle-text: #7f8c8d;
        }

        .dark-mode {
            --bg-color: #1a1a2e;
            --container-bg: #16213e;
            --text-color: #e6e6e6;
            --border-color: #394867;
            --primary-color: #4cc9f0;
            --header-color: #e6e6e6;
            --secondary-text: #a9a9a9;
            --progress-bg: #394867;
            --question-bg: #1f4068;
            --option-bg: #16213e;
            --option-hover: #1f4068;
            --option-selected: #1f4068;
            --correct-bg: #2d5a2d;
            --correct-border: #4caf50;
            --incorrect-bg: #5a2d2d;
            --incorrect-border: #f44336;
            --button-bg: #4cc9f0;
            --button-hover: #3aa8d0;
            --button-disabled: #5d6d7e;
            --restart-bg: #2ecc71;
            --restart-hover: #27ae60;
            --review-bg: #f39c12;
            --review-hover: #e67e22;
            --toggle-bg: #394867;
            --toggle-slider: #4cc9f0;
            --toggle-text: #e6e6e6;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
            transition: background-color 0.3s, color 0.3s;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--container-bg);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s, box-shadow 0.3s;
        }
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--primary-color);
            position: relative;
        }
        h1 {
            color: var(--header-color);
            margin-bottom: 5px;
            font-size: 24px;
            transition: color 0.3s;
        }
        .author {
            color: var(--secondary-text);
            font-style: italic;
            margin-bottom: 10px;
            transition: color 0.3s;
        }
        .description {
            color: var(--secondary-text);
            margin-bottom: 20px;
            transition: color 0.3s;
        }
        .theme-toggle {
            position: absolute;
            top: 35px; /* Adjusted to align with author name */
            right: 0;
            display: flex;
            align-items: center;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 120px;
            height: 34px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--toggle-bg);
            transition: .4s;
            border-radius: 34px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 10px;
            font-size: 12px;
            font-weight: bold;
            color: var(--toggle-text);
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 60px;
            left: 4px;
            bottom: 4px;
            background-color: var(--toggle-slider);
            transition: .4s;
            border-radius: 34px;
            z-index: 1;
        }
        .slider-text {
            position: relative;
            z-index: 2;
            width: 100%;
            display: flex;
            justify-content: space-between;
        }
        .light-text, .dark-text {
            transition: opacity 0.3s;
        }
        .dark-mode .light-text {
            opacity: 0.5;
        }
        .light-text {
            opacity: 0.5;
        }
        .dark-mode .dark-text {
            opacity: 1;
        }
        .dark-text {
            opacity: 0.5;
        }
        input:checked + .slider:before {
            transform: translateX(52px);
        }
        .progress-container {
            background: var(--progress-bg);
            border-radius: 5px;
            margin-bottom: 20px;
            position: relative;
            height: 10px;
            transition: background-color 0.3s;
        }
        .progress-bar {
            height: 100%;
            background: var(--primary-color);
            border-radius: 5px;
            width: 0%;
            transition: width 0.3s ease, background-color 0.3s;
        }
        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-weight: bold;
            color: var(--header-color);
            transition: color 0.3s;
        }
        .question {
            background: var(--question-bg);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: background-color 0.3s;
        }
        .question-number {
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
            transition: color 0.3s;
        }
        .question-text {
            font-size: 18px;
            margin-bottom: 15px;
        }
        .options {
            display: grid;
            grid-gap: 10px;
        }
        .option {
            padding: 12px 15px;
            background: var(--option-bg);
            border: 2px solid var(--border-color);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .option:hover {
            background: var(--option-hover);
            border-color: var(--primary-color);
        }
        .option.selected {
            background: var(--option-selected);
            border-color: var(--primary-color);
        }
        .option.correct {
            background: var(--correct-bg);
            border-color: var(--correct-border);
        }
        .option.incorrect {
            background: var(--incorrect-bg);
            border-color: var(--incorrect-border);
        }
        .feedback {
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            display: none;
        }
        .feedback.correct {
            background: var(--correct-bg);
            color: var(--text-color);
            border: 1px solid var(--correct-border);
            display: block;
        }
        .feedback.incorrect {
            background: var(--incorrect-bg);
            color: var(--text-color);
            border: 1px solid var(--incorrect-border);
            display: block;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        button {
            padding: 10px 20px;
            background: var(--button-bg);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }
        button:hover {
            background: var(--button-hover);
        }
        button:disabled {
            background: var(--button-disabled);
            cursor: not-allowed;
        }
        .results {
            text-align: center;
            padding: 30px;
            display: none;
        }
        .score {
            font-size: 24px;
            margin-bottom: 20px;
            color: var(--header-color);
        }
        .score-value {
            font-size: 48px;
            color: var(--primary-color);
            font-weight: bold;
        }
        .restart-btn {
            margin-top: 20px;
            background: var(--restart-bg);
        }
        .restart-btn:hover {
            background: var(--restart-hover);
        }
        .review-btn {
            margin-top: 20px;
            background: var(--review-bg);
        }
        .review-btn:hover {
            background: var(--review-hover);
        }
        .review-section {
            margin-top: 30px;
            padding: 20px;
            background: var(--question-bg);
            border-radius: 8px;
            display: none;
        }
        .review-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--header-color);
            text-align: center;
        }
        .review-question {
            margin-bottom: 20px;
            padding: 15px;
            border-left: 4px solid var(--incorrect-border);
            background: var(--container-bg);
            border-radius: 4px;
        }
        .review-question-number {
            font-weight: bold;
            color: var(--incorrect-border);
            margin-bottom: 8px;
        }
        .review-question-text {
            margin-bottom: 10px;
        }
        .review-answer {
            margin-top: 8px;
            font-weight: bold;
        }
        .review-correct {
            color: var(--correct-border);
        }
        .review-explanation {
            margin-top: 5px;
            font-style: italic;
            color: var(--secondary-text);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>MCQs on Electrotherapy 1 Lecture No. 3 Quiz</h1>
            <p class="author">Dr. Samy Salem</p>
            <p class="description">Test your knowledge of Electrotherapy 1 Lecture No. 3</p>
            <div class="theme-toggle">
                <label class="switch">
                    <input type="checkbox" id="dark-mode-toggle">
                    <span class="slider">
                        <div class="slider-text">
                            <span class="light-text">Light</span>
                            <span class="dark-text">Dark</span>
                        </div>
                    </span>
                </label>
            </div>
        </header>

        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>

        <div class="stats">
            <div>Question: <span id="current-question">1</span>/<span id="total-questions">30</span></div>
            <div>Score: <span id="score">0</span>/<span id="total-score">30</span></div>
        </div>

        <div id="quiz-container">
            <!-- Questions will be inserted here by JavaScript -->
        </div>

        <div class="navigation">
            <button id="prev-btn" disabled>Previous</button>
            <button id="next-btn">Next</button>
        </div>

        <div id="results" class="results">
            <div class="score">Your Score: <span class="score-value" id="final-score">0</span>/30</div>
            <p id="performance-message"></p>
            <button class="restart-btn" id="restart-btn">Restart Quiz</button>
            <button class="review-btn" id="review-btn">Review Incorrect Answers</button>
        </div>

        <div id="review-section" class="review-section">
            <h2 class="review-title">Questions Answered Incorrectly</h2>
            <div id="incorrect-questions-list"></div>
        </div>
    </div>

    <script>
        // Quiz data (all 30 questions from the PDF)
        const quizData = [
            {
                question: "What is the primary purpose of Transcutaneous Electrical Nerve Stimulation (TENS)?",
                options: [
                    "To stimulate nerve fibers to produce different physiological effects, mostly to control pain",
                    "To strengthen muscles",
                    "To increase joint range of motion",
                    "To reduce muscle spasticity"
                ],
                answer: 0,
                explanation: "To stimulate nerve fibers to produce different physiological effects, mostly to control pain (Page 3)"
            },
            {
                question: "Which mode of TENS is characterized by low intensity, high frequency (80-110 Hz), and short pulse duration (50-100 μsec)?",
                options: [
                    "Acupuncture-Like TENS",
                    "Burst Train TENS",
                    "Conventional TENS",
                    "Brief Intense TENS"
                ],
                answer: 2,
                explanation: "Conventional TENS (Page 6)"
            },
            {
                question: "Conventional TENS preferentially activates which type of nerve fibers to produce a comfortable paresthesia without a motor response?",
                options: [
                    "Group I (Aa) afferent fibers",
                    "Group II (AB) afferent fibers",
                    "Group III (Aδ) afferent fibers",
                    "Group IV (C) afferent fibers"
                ],
                answer: 1,
                explanation: "Group II (AB) afferent fibers (Page 7)"
            },
            {
                question: "Acupuncture-Like TENS uses stimulation parameters that include:",
                options: [
                    "Frequency below 10 Hz and long pulse duration (≥200 μsec) at motor level",
                    "High frequency (80-110 Hz) and short pulse duration at sensory level",
                    "High-frequency trains delivered at a low frequency",
                    "High frequency for a short period at the patient's highest tolerable intensity"
                ],
                answer: 0,
                explanation: "Frequency below 10 Hz and long pulse duration (≥200 μsec) at motor level (Page 9)"
            },
            {
                question: "Which TENS mode combines conventional and acupuncture-like TENS, delivering high-frequency pulse trains at a low frequency?",
                options: [
                    "Conventional TENS",
                    "Brief Intense TENS",
                    "Burst Train TENS",
                    "Sensory TENS"
                ],
                answer: 2,
                explanation: "Burst Train TENS (Page 11)"
            },
            {
                question: "Patients often prefer Burst Train TENS over Acupuncture-Like TENS because:",
                options: [
                    "It uses a higher frequency",
                    "The pulse trains produce a more comfortable muscle contraction",
                    "It has a shorter treatment time",
                    "It requires a lower intensity"
                ],
                answer: 1,
                explanation: "The pulse trains produce a more comfortable muscle contraction (Page 11)"
            },
            {
                question: "Brief Intense TENS is characterized by all of the following EXCEPT:",
                options: [
                    "High frequency (100-150 Hz)",
                    "Long pulse duration (150-250 μsec)",
                    "Amplitude at the patient's highest tolerable intensity",
                    "Treatment duration generally over 30 minutes"
                ],
                answer: 3,
                explanation: "Treatment duration generally over 30 minutes (Page 13)"
            },
            {
                question: "Acute pain is generally described as pain lasting:",
                options: [
                    "Less than 12 weeks",
                    "3 to 6 months",
                    "More than 6 months",
                    "Exactly 1 year"
                ],
                answer: 0,
                explanation: "Less than 12 weeks (Page 16)"
            },
            {
                question: "Chronic pain is commonly defined as persistent or recurrent pain existing for:",
                options: [
                    "Less than 12 weeks",
                    "1 to 2 months",
                    "3 to 6 months or beyond the normal healing time",
                    "More than 1 year"
                ],
                answer: 2,
                explanation: "3 to 6 months or beyond the normal healing time (Page 17)"
            },
            {
                question: "Referred pain occurs at a site remote from the source due to:",
                options: [
                    "Direct nerve damage",
                    "Convergence of nociceptors on the common nerve root of the spinal cord",
                    "Psychological factors",
                    "Muscle weakness"
                ],
                answer: 1,
                explanation: "Convergence of nociceptors on the common nerve root of the spinal cord (Page 18)"
            },
            {
                question: "According to the pain pathway, where do the first-order neurons from nociceptors terminate in the spinal cord?",
                options: [
                    "Lamina I, V for fast pain (Aδ); Lamina II, III for slow pain (C fibers)",
                    "Lamina IX and X",
                    "The ventral horn",
                    "The spinothalamic tract directly"
                ],
                answer: 0,
                explanation: "Lamina I, V for fast pain (Aδ); Lamina II, III for slow pain (C fibers) (Page 19)"
            },
            {
                question: "The second-order neurons in the pain pathway decussate and ascend in which tract?",
                options: [
                    "Dorsal Column-Medial Lemniscal tract",
                    "Lateral Corticospinal tract",
                    "Lateral Spinothalamic tract",
                    "Anterior Spinothalamic tract"
                ],
                answer: 2,
                explanation: "Lateral Spinothalamic tract (Page 20)"
            },
            {
                question: "The third-order neuron in the neospinothalamic pathway projects from the thalamus to the:",
                options: [
                    "Reticular formation",
                    "Cerebellum",
                    "Somatosensory cortex (area 3,1,2)",
                    "Hypothalamus"
                ],
                answer: 2,
                explanation: "Somatosensory cortex (area 3,1,2) (Page 20)"
            },
            {
                question: "The paleospinothalamic pathway (associated with chronic pain) terminates in the:",
                options: [
                    "Primary motor cortex",
                    "Reticular area of the brain stem",
                    "Somatosensory cortex",
                    "Ventral posterior lateral nucleus of the thalamus only"
                ],
                answer: 1,
                explanation: "Reticular area of the brain stem (Page 21)"
            },
            {
                question: "Enkephalins are found in all of the following areas EXCEPT:",
                options: [
                    "Periaqueductal grey matter",
                    "Raphe Magnus nucleus",
                    "Substantia gelatinosa of the dorsal horn",
                    "Anterior pituitary gland"
                ],
                answer: 3,
                explanation: "Anterior pituitary gland (Page 23)"
            },
            {
                question: "Large amounts of endorphins are found in the:",
                options: [
                    "Spinal cord dorsal horn",
                    "Hypothalamus and pituitary gland",
                    "Periaqueductal grey matter only",
                    "Cerebral cortex"
                ],
                answer: 1,
                explanation: "Hypothalamus and pituitary gland (Page 24)"
            },
            {
                question: "One of the main sources of β-Endorphin (BEP) is the:",
                options: [
                    "Substantia gelatinosa",
                    "Anterior pituitary gland",
                    "Raphe nucleus",
                    "Dorsal root ganglion"
                ],
                answer: 1,
                explanation: "Anterior pituitary gland (Page 25)"
            },
            {
                question: "According to the Gate Control Theory, stimulation of large-diameter Aβ fibers:",
                options: [
                    "Directly blocks pain signals in the brain",
                    "Activates inhibitory interneurons in the substantia gelatinosa to close the gate",
                    "Opens the gate for more pain signals",
                    "Stimulates the release of endorphins from the pituitary"
                ],
                answer: 1,
                explanation: "Activates inhibitory interneurons in the substantia gelatinosa to close the gate (Page 30, 34)"
            },
            {
                question: "In the spinal cord, incoming Aβ fibers from cutaneous mechanoreceptors synapse in laminae:",
                options: [
                    "I-II",
                    "III-VI",
                    "VII-IX",
                    "X only"
                ],
                answer: 1,
                explanation: "III-VI (Page 31)"
            },
            {
                question: "The supra-spinal inhibition mechanism of TENS involves stimulation leading to the release of enkephalins in the dorsal horn, which is initiated by the:",
                options: [
                    "Somatosensory cortex",
                    "Ventral posterior lateral nucleus of the thalamus",
                    "Dorsal root ganglion",
                    "Periaqueductal grey and raphe nucleus"
                ],
                answer: 3,
                explanation: "Periaqueductal grey and raphe nucleus (Page 36, 37)"
            },
            {
                question: "Which of the following is NOT an electrode configuration for TENS application?",
                options: [
                    "Electrodes placed around or over the painful area",
                    "Electrodes positioned over the course of the peripheral nerve",
                    "Electrodes placed parallel to the spine on the intervertebral foramen",
                    "Electrodes placed directly over major blood vessels"
                ],
                answer: 3,
                explanation: "Electrodes placed directly over major blood vessels (Page 40, 41)"
            },
            {
                question: "What is the recommended initial treatment time for TENS?",
                options: [
                    "5 minutes",
                    "15 minutes",
                    "30 minutes",
                    "2 hours"
                ],
                answer: 2,
                explanation: "30 minutes (Page 43)"
            },
            {
                question: "When initiating TENS treatment, the current amplitude should be:",
                options: [
                    "At the patient's highest tolerable level",
                    "At a level that causes strong muscle contraction",
                    "At the minimum value (zero)",
                    "Pre-set to 50% of maximum"
                ],
                answer: 2,
                explanation: "At the minimum value (zero) (Page 45)"
            },
            {
                question: "The current amplitude should be increased until the patient reports:",
                options: [
                    "A strong but comfortable sensation",
                    "A painful muscle twitch",
                    "No sensation at all",
                    "A burning feeling"
                ],
                answer: 0,
                explanation: "A strong but comfortable sensation (Page 46)"
            },
            {
                question: "Which of the following is an absolute contraindication for TENS?",
                options: [
                    "Mild muscle soreness",
                    "Pacemaker or other active implants",
                    "Old scar tissue",
                    "Mild hypertension"
                ],
                answer: 1,
                explanation: "Pacemaker or other active implants (Page 48)"
            },
            {
                question: "Application of TENS is contraindicated over which of the following areas?",
                options: [
                    "The lower back",
                    "The quadriceps muscle",
                    "The eyes, internally, and on reproductive organs",
                    "The shoulder joint"
                ],
                answer: 2,
                explanation: "The eyes, internally, and on reproductive organs (Page 49)"
            },
            {
                question: "A precaution for TENS application includes:",
                options: [
                    "Undiagnosed pain",
                    "Healthy skin",
                    "Normal cognition",
                    "Absence of thrombosis"
                ],
                answer: 0,
                explanation: "Undiagnosed pain (Page 50)"
            },
            {
                question: "Which TENS mode uses a pulse duration of 150-200 μsec and is applied at motor level?",
                options: [
                    "Conventional TENS",
                    "Acupuncture-Like TENS",
                    "Both Acupuncture-Like and Burst Train TENS",
                    "Only Conventional TENS"
                ],
                answer: 2,
                explanation: "Both Acupuncture-Like and Burst Train TENS (Page 15)"
            },
            {
                question: "The Gate Control Theory primarily explains pain relief by TENS through the stimulation of:",
                options: [
                    "Aδ fibers to release endorphins",
                    "C fibers to block Aβ transmission",
                    "Aβ fibers to activate inhibitory circuits in the dorsal horn",
                    "Motor fibers to cause muscle fatigue"
                ],
                answer: 2,
                explanation: "Aβ fibers to activate inhibitory circuits in the dorsal horn (Page 27, 30)"
            },
            {
                question: "The physiological effect of Conventional TENS is primarily attributed to which mechanism?",
                options: [
                    "Gate Control Theory",
                    "Supra-spinal Inhibition and endogenous opioid release",
                    "Muscle fatigue",
                    "Placebo effect"
                ],
                answer: 0,
                explanation: "Gate Control Theory (Page 7, 27, 29)"
            }
        ];

        // Quiz state variables
        let currentQuestion = 0;
        let score = 0;
        let userAnswers = new Array(quizData.length).fill(null);
        let incorrectQuestions = [];

        // DOM elements
        const quizContainer = document.getElementById('quiz-container');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const progressBar = document.getElementById('progress-bar');
        const currentQuestionEl = document.getElementById('current-question');
        const totalQuestionsEl = document.getElementById('total-questions');
        const scoreEl = document.getElementById('score');
        const totalScoreEl = document.getElementById('total-score');
        const resultsContainer = document.getElementById('results');
        const finalScoreEl = document.getElementById('final-score');
        const performanceMessageEl = document.getElementById('performance-message');
        const restartBtn = document.getElementById('restart-btn');
        const reviewBtn = document.getElementById('review-btn');
        const reviewSection = document.getElementById('review-section');
        const incorrectQuestionsList = document.getElementById('incorrect-questions-list');
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        const lightText = document.querySelector('.light-text');
        const darkText = document.querySelector('.dark-text');

        // Initialize quiz
        function initQuiz() {
            totalQuestionsEl.textContent = quizData.length;
            totalScoreEl.textContent = quizData.length;
            showQuestion();
            updateProgressBar();
            
            // Initialize dark mode based on system preference
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.classList.add('dark-mode');
                darkModeToggle.checked = true;
                updateToggleText(true);
            } else {
                updateToggleText(false);
            }
            
            // Event listeners
            prevBtn.addEventListener('click', showPreviousQuestion);
            nextBtn.addEventListener('click', showNextQuestion);
            restartBtn.addEventListener('click', restartQuiz);
            reviewBtn.addEventListener('click', showIncorrectQuestions);
            darkModeToggle.addEventListener('change', toggleDarkMode);
        }

        // Toggle dark mode
        function toggleDarkMode() {
            const isDarkMode = darkModeToggle.checked;
            document.body.classList.toggle('dark-mode', isDarkMode);
            updateToggleText(isDarkMode);
        }

        // Update toggle text opacity
        function updateToggleText(isDarkMode) {
            if (isDarkMode) {
                lightText.style.opacity = '0.5';
                darkText.style.opacity = '1';
            } else {
                lightText.style.opacity = '1';
                darkText.style.opacity = '0.5';
            }
        }

        // Show current question
        function showQuestion() {
            currentQuestionEl.textContent = currentQuestion + 1;
            scoreEl.textContent = score;
            
            const question = quizData[currentQuestion];
            let optionsHTML = '';
            
            question.options.forEach((option, index) => {
                let optionClass = 'option';
                if (userAnswers[currentQuestion] === index) {
                    optionClass += ' selected';
                    if (index === question.answer) {
                        optionClass += ' correct';
                    } else {
                        optionClass += ' incorrect';
                    }
                }
                
                optionsHTML += `
                    <div class="${optionClass}" data-index="${index}">
                        ${String.fromCharCode(65 + index)}) ${option}
                    </div>
                `;
            });
            
            let feedbackHTML = '';
            if (userAnswers[currentQuestion] !== null) {
                const isCorrect = userAnswers[currentQuestion] === question.answer;
                feedbackHTML = `
                    <div class="feedback ${isCorrect ? 'correct' : 'incorrect'}">
                        ${isCorrect ? '✓ Correct!' : '✗ Incorrect!'} 
                        ${!isCorrect ? `Correct answer: ${String.fromCharCode(65 + question.answer)}) ${question.options[question.answer]}` : ''}
                        <br><br>Explanation: ${question.explanation}
                    </div>
                `;
            }
            
            quizContainer.innerHTML = `
                <div class="question">
                    <div class="question-number">Question ${currentQuestion + 1}/${quizData.length}</div>
                    <div class="question-text">${question.question}</div>
                    <div class="options">${optionsHTML}</div>
                    ${feedbackHTML}
                </div>
            `;
            
            // Add event listeners to options
            const optionElements = quizContainer.querySelectorAll('.option');
            optionElements.forEach(option => {
                option.addEventListener('click', selectOption);
            });
            
            // Update navigation buttons
            prevBtn.disabled = currentQuestion === 0;
            nextBtn.textContent = currentQuestion === quizData.length - 1 ? 'Finish Quiz' : 'Next';
        }

        // Select an option
        function selectOption(e) {
            if (userAnswers[currentQuestion] !== null) return; // Already answered
            
            const selectedOption = e.currentTarget;
            const selectedIndex = parseInt(selectedOption.dataset.index);
            
            userAnswers[currentQuestion] = selectedIndex;
            
            // Check if answer is correct
            if (selectedIndex === quizData[currentQuestion].answer) {
                score++;
                scoreEl.textContent = score;
            } else {
                // Add to incorrect questions list
                incorrectQuestions.push({
                    question: quizData[currentQuestion].question,
                    userAnswer: selectedIndex,
                    correctAnswer: quizData[currentQuestion].answer,
                    options: quizData[currentQuestion].options,
                    explanation: quizData[currentQuestion].explanation,
                    questionNumber: currentQuestion + 1
                });
            }
            
            showQuestion();
            updateProgressBar();
        }

        // Show next question
        function showNextQuestion() {
            if (currentQuestion < quizData.length - 1) {
                currentQuestion++;
                showQuestion();
            } else {
                showResults();
            }
        }

        // Show previous question
        function showPreviousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion();
            }
        }

        // Update progress bar
        function updateProgressBar() {
            const progress = ((currentQuestion + 1) / quizData.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        // Show results
        function showResults() {
            quizContainer.style.display = 'none';
            document.querySelector('.navigation').style.display = 'none';
            document.querySelector('.progress-container').style.display = 'none';
            document.querySelector('.stats').style.display = 'none';
            
            finalScoreEl.textContent = score;
            
            // Performance message
            const percentage = (score / quizData.length) * 100;
            let message = '';
            if (percentage >= 80) {
                message = 'Excellent! You have a strong understanding of Electrotherapy 1 Lecture No. 3.';
            } else if (percentage >= 60) {
                message = 'Good job! You have a solid grasp of the material.';
            } else if (percentage >= 40) {
                message = 'Not bad! Review the material and try again.';
            } else {
                message = 'Keep studying! Review the lectures and try again.';
            }
            
            performanceMessageEl.textContent = message;
            resultsContainer.style.display = 'block';
            
            // Show review button only if there are incorrect answers
            if (incorrectQuestions.length > 0) {
                reviewBtn.style.display = 'inline-block';
            } else {
                reviewBtn.style.display = 'none';
            }
        }

        // Show incorrect questions
        function showIncorrectQuestions() {
            resultsContainer.style.display = 'none';
            reviewSection.style.display = 'block';
            
            let incorrectHTML = '';
            incorrectQuestions.forEach((item, index) => {
                incorrectHTML += `
                    <div class="review-question">
                        <div class="review-question-number">Question ${item.questionNumber}</div>
                        <div class="review-question-text">${item.question}</div>
                        <div>Your answer: ${String.fromCharCode(65 + item.userAnswer)}) ${item.options[item.userAnswer]}</div>
                        <div class="review-answer review-correct">Correct answer: ${String.fromCharCode(65 + item.correctAnswer)}) ${item.options[item.correctAnswer]}</div>
                        <div class="review-explanation">${item.explanation}</div>
                    </div>
                `;
            });
            
            incorrectQuestionsList.innerHTML = incorrectHTML;
        }

        // Restart quiz
        function restartQuiz() {
            currentQuestion = 0;
            score = 0;
            userAnswers = new Array(quizData.length).fill(null);
            incorrectQuestions = [];
            
            quizContainer.style.display = 'block';
            document.querySelector('.navigation').style.display = 'flex';
            document.querySelector('.progress-container').style.display = 'block';
            document.querySelector('.stats').style.display = 'flex';
            resultsContainer.style.display = 'none';
            reviewSection.style.display = 'none';
            
            showQuestion();
            updateProgressBar();
        }

        // Initialize the quiz when the page loads
        window.addEventListener('load', initQuiz);
    </script>
</body>
</html>